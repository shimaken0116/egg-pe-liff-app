# GAS Webアプリのデプロイ（公開）手順書

## 1. 概要

作成したGoogle Apps Scriptを「Webアプリ」としてデプロイし、外部（LIFFアプリ）からHTTPリクエストを受け取れるように設定します。

## 2. デプロイ手順

1.  GASエディタの画面右上にある青い**「デプロイ」**ボタンをクリックします。
2.  ドロップダウンメニューから**「新しいデプロイ」**を選択します。
3.  歯車アイコンの「種類の選択」の横にある**「有効にする」**をクリックし、デプロイタイプを「**ウェブアプリ**」に設定します。
4.  以下の通りに設定を入力します。
    *   **説明**: `v1` や `初回リリース` など、変更内容がわかるように入力します。（任意）
    *   **次のユーザーとして実行**: **「自分（あなたのメールアドレス）」** を選択します。
        *   *重要: これにより、スクリプトはあなた自身の権限でスプレッドシートに書き込みます。*
    *   **アクセスできるユーザー**: **「全員」** を選択します。
        *   *重要: LIFFアプリから呼び出すために、アクセス権を全員に許可する必要があります。セキュリティはコード内のIDトークン検証で担保されているため、ご安心ください。*
5.  **「デプロイ」** ボタンをクリックします。
6.  （初回のみ）「承認が必要です」というポップアップが表示されます。
    *   **「アクセスを承認」** をクリックします。
    *   自分のGoogleアカウントを選択します。
    *   「このアプリはGoogleで確認されていません」という警告画面が出たら、左下の**「詳細」**をクリックし、**「（プロジェクト名）に移動（安全ではないページ）」** をクリックして許可します。
    *   次の画面で、スプレッドシートへのアクセス許可を求められるので**「許可」**をクリックします。
7.  デプロイが完了すると、「デプロイが更新されました」という画面に**ウェブアプリのURL**が表示されます。
    *   このURLは後でLIFFアプリの設定に使うので、**必ず「コピー」ボタンを押して控えておいてください。**

## 3. LIFFアプリのエンドポイントURL設定

1.  [LINE Developersコンソール](https://developers.line.biz/ja/)を開き、該当のLINEログインチャネルを選択します。
2.  `LIFF`タブを開き、作成済みのLIFFアプリを選択します。
3.  **「Endpoint URL」** の項目に、先ほどコピーした**GASのウェブアプリURL**を貼り付けます。
4.  一番下の「更新」ボタンを押して、設定を保存します。

これで、LIFFアプリとGASバックエンドの連携が完了しました。
